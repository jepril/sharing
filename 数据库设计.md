# 数据库设计

数据库设计(Database Design)是指对于一个给定的应用环境，构造最优的数据库[模式](https://baike.baidu.com/item/模式/700029)，建立数据库及其应用系统，使之能够有效地[存储数据](https://baike.baidu.com/item/存储数据/14717603)，满足各种用户的应用需求（信息要求和处理要求）。



数据库设计是非常重要的，举个简单的例子，木犀课栈，如果你数据库设计的不好，假如没有储存用户评分，你就要建一个新的数据库，而且还是数据库表结构不同，并且要数据迁移，数据迁移已经很麻烦了（ETL），迁移时，一般还要停用旧的数据库，那样会影响用户体验。

## 设计步骤

![](https://i.loli.net/2020/12/12/76vluYPQXOF2jBd.jpg)

![](https://i.loli.net/2020/12/12/OaKGgN86pi2IBf7.jpg)

今天我们主要讲设计概念结构

## （一）概念模型

### 1.0 特点

- 能真实、充分地反映现实世界，包括事物和事物之间的联系，能满足用户对数据的处理要求，是现实世界的一个真实模型。

- 易于理解，可以用它和不熟悉计算机的用户交换意见。用户的积极参与是数据库设计成功的关键。

- 易于更改，当应用环境和应用要求改变时容易对概念模型修改和打充。

- 易于向关系、网状、层次等各种数据模型转换。

概念模型是各种数据模型的共同基础，它比数据模型更独立于机器、更抽象，从而更加稳定。描述概念模型的有力工具是ER模型。

### 1.1收集信息

​	在创建数据库之前，我们要充分理解数据库需要完成的任务和功能。简单的说，就是需要了解数据库需要存储哪些信息和数据，要实现哪些功能。（就是说，miniproject你们要好	好和产品组的同学~~商量~~（battle）一下）以选课为例。

- 学生选课这个情景就是我们收集到的信息

### 1.2.1 ***<u>实体</u>*** （很重要） 

​	数据模型中的数据对象，可以理解为数据表。实体可以是有形的事物，比如说人或产品；也可能是无形的事物，比如说课程等等。；通过“**矩形框**”表示实体型，矩形框内写明实体	名称。

- 学生
- 课程

### 1.2.1属性

​	实体所具有的属性，可以理解为数据表中的字段；通过**“椭圆图框”**表示实体的属性，并	用“实心线段”与“实体型”连接起来；属性分为唯一和非唯一，唯一属性(数据表中的主键)用下划线表示。

- 学生：学号，姓名，性别，专业
- 课程：编号，课名，老师，教室

### 1.3 如何区别实体和属性

大家是不是认为这个很好区分？但是别忘了，老师是一个具体的事物，但它也可以作为属性，而课程也可以作为属性。只是看你的应用场合。

- **原则：** 为了简化E-R图的处置，现实世界的事物能作为属性对待的尽量作为属性对待。

- **准则：** 

  - 作为属性，不能再具有需要描述的性质，即属性必须是不可分的数据项，不能包含其他属性。

  - 属性不能与其他实体具有联系，即E-R图中所表示的联系是实体之间的联系。

### 1.4 关系

​	数据对象与数据对象之间的联系，可以理解为数据表与数据表之间的关系；通过**”菱形框“**表示实体型之间的关系，在框内写明关系，并用**”实心线段“**与有关实体型连接起来，同时在”实心线段“旁标上联系的类型（1:1,1:n或m:n）。

- 一对一联系（1:1）
    例如，一个部门有一个经理，而每个经理只在一个部门任职，则部门与经理的联系是一对一的。
- 一对多联系（1:N）
    例如，某校教师与课程之间存在一对多的联系“教”，即每位教师可以教多门课程，但是每门课程只能由一位教师来教。
- 多对多联系（M:N）
    例如，学生与课程间的联系（“学”）是多对多的，即一个学生可以学多门课程，而每门课程可以有多个学生来学。

联系也可能有属性。例如，学生“学”某门课程所取得的成绩，既不是学生的属性也不是课程的属性。由于“成绩”既依赖于某名特定的学生又依赖于某门特定的课程，所以它是学生与课程之间的联系“学”的属性。

- 选择（拥有）

关系确认需要从正反两个角度去思考，对于两个实体集A和B，观察A中的实体值在B中实体值的对应关系，反之B中实体值在A中实体值的对应关系，如果两者得出的关系一致那就可以确认是这种关系了。例如教师-课程之间的关系，1位教师可以有N门课程，但是每门课程就只有1位教师，从这个角度分析教师-课程之间是1:N的关系。

### 1.5 ER图

![](https://i.loli.net/2020/12/12/vUnfIPgzSB89A1p.png)

### 1.5.1 例子

- 例如，职工是一个实体，职工号、姓名、年龄是职工的属性，职称如果没有与工资、岗位津贴、福利挂钩，换句话说，没有需要进一一步 描述的特性，则根据准则(1)可以作为职工实体的属性;但如果不同的职称有不同的工资、岗位津贴和不同的附加福利，则职称作为一个实体看待就更恰当。

![](https://i.loli.net/2020/12/12/JqGV7rSaKAgQDYt.jpg)

如果一种货物只存放在一个仓库中，那么就可以把存放货物的仓库的仓库号作为描述货物存放地点的属性，但如果一种 货物可以存放在多个仓库中，或者仓库本身又用面积作为属性，或者仓库与职工发生管理上的联系，那么就应把仓库作为一个实体。

![](https://i.loli.net/2020/12/12/p7Qi5hxHzctVSvR.jpg)



## 分析类之间的关系

### 2.1 类

![](http://www.sparxsystems.cn/images/screenshots/umldb_1.gif)

类在UML中是一个基本的逻辑实体。它定义了一个结构单元的数据和行为。一个类是一个模板或运行时创建实例和对象的模型。

- 属性：类似er图的属性。
- 行为：对类的操作。

### 2.2 UML图

![](https://i.loli.net/2020/12/11/IdfNpzosuHOeiEy.png)

![](https://i.loli.net/2020/12/12/slhZ13RyPq2u75i.jpg)

## 构建sql文档

![](https://images2015.cnblogs.com/blog/1015711/201609/1015711-20160930085939235-498294044.png)

抽象数据库设计->实例化

- 写sql文档
- 导入mysql：source sql文件的路径



## 在哪写

https://www.processon.com/（选择uml图文件）

数据库系统概论

